version: 2

models:
  - name: int_listing_amenities_scd
    description: |
      SCD Type 2 table tracking amenity changes over time.
      Each row represents a period during which a listing had a specific set of amenities.
      Use valid_from and valid_to for point-in-time joins.
    columns:
      - name: listing_id
        description: Foreign key to listings
        tests:
          - not_null
      - name: valid_from
        description: Start date of this amenity configuration (inclusive)
        tests:
          - not_null
      - name: valid_to
        description: End date of this amenity configuration (inclusive)
        tests:
          - not_null
  
  - name: int_calendar_enriched
    description: |
      Calendar data enriched with listing attributes and point-in-time correct amenities.
      Serves as the primary input to the daily fact table.
    columns:
      - name: listing_id
        description: Foreign key to listings
        tests:
          - not_null
      - name: calendar_date
        description: The calendar date
        tests:
          - not_null
  
  - name: int_availability_spans
    description: |
      Calculated availability spans showing consecutive available periods.
      Used for maximum stay duration analysis.
    columns:
      - name: listing_id
        description: Foreign key to listings
        tests:
          - not_null
      - name: span_start_date
        description: First available date in the span
        tests:
          - not_null
      - name: span_end_date
        description: Last available date in the span
        tests:
          - not_null
      - name: duration_days
        description: Number of days in this span
  
  - name: int_hosts_history
    description: |
      Intermediate preparation for host SCD dimension.
      Derives host history from listings data.
    columns:
      - name: host_id
        description: Unique host identifier
        tests:
          - unique
          - not_null
      - name: valid_from
        description: Start of validity period
        tests:
          - not_null
      - name: valid_to
        description: End of validity period
        tests:
          - not_null
  
  - name: int_listings_history
    description: |
      Intermediate preparation for listings SCD dimension.
      Tracks listing attribute changes over time.
    columns:
      - name: listing_id
        description: Foreign key to listings
        tests:
          - not_null
      - name: valid_from
        description: Start of validity period
        tests:
          - not_null
      - name: valid_to
        description: End of validity period
        tests:
          - not_null
